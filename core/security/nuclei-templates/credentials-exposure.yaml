id: credentials-exposure

info:
  name: Credentials File Exposure
  author: Demon Slayers Training Lab
  severity: high
  description: Detects exposed credentials files containing sensitive information
  reference:
    - https://owasp.org/www-community/vulnerabilities/Information_exposure
  tags: credentials,information-disclosure,exposure,secrets

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/credentials"
      - "{{BaseURL}}/credentials.txt"
      - "{{BaseURL}}/credentials"
      - "{{BaseURL}}/.credentials"
      - "{{BaseURL}}/config/credentials.txt"

    matchers:
      - type: word
        words:
          - "User Credentials"
          - "Admin Credentials"
          - "Email:"
          - "Password:"
          - "Database Connection"
          - "DB_PASSWORD"
        condition: or
        part: body

      - type: status
        status:
          - 200

    matchers-condition: and

